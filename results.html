<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>RÃ©sultats â€” Skull King</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1e3a8a">
<style>
  .player {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    margin: 6px 0;
    background: #f5f5f5;
    border-radius: 10px;
    transition: transform 0.5s ease, background 0.3s;
    position: relative;
  }

  .player.revealed {
    background: #e8ffe8;
  }

  .player .score {
    font-weight: bold;
    font-size: 18px;
  }

  .crown {
    position: absolute;
    top: -18px;
    left: 50%;
    transform: translateX(-50%);
    font-size: 22px;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .player.leader .crown {
    opacity: 1;
  }

  #results {
    max-width: 400px;
    margin: 20px auto;
  }

  #revealBtn {
    display: block;
    margin: 20px auto;
    padding: 10px 20px;
    border: none;
    background: #0077cc;
    color: white;
    font-weight: bold;
    border-radius: 8px;
    cursor: pointer;
  }
</style>

<div id="results"></div>
<button id="revealBtn">RÃ©vÃ©ler le prochain</button>

<script>
  // Exemple de joueurs (Ã  remplacer par tes vrais joueurs et scores)
  const players = [
    { name: "Alice", score: 12 },
    { name: "Bob", score: 9 },
    { name: "Charlie", score: 15 },
    { name: "Diana", score: 7 }
  ];

  // MÃ©langer l'ordre initial
  const shuffled = players
    .map(p => ({ ...p, revealed: false }))
    .sort(() => Math.random() - 0.5);

  const resultsContainer = document.getElementById("results");

  function renderInitial() {
    resultsContainer.innerHTML = "";
    shuffled.forEach(p => {
      const div = document.createElement("div");
      div.className = "player";
      div.dataset.name = p.name;
      div.innerHTML = `
        <span>${p.name}</span>
        <span class="score">?</span>
        <div class="crown">ðŸ‘‘</div>
      `;
      resultsContainer.appendChild(div);
    });
  }

  function revealNext() {
    const next = shuffled.find(p => !p.revealed);
    if (!next) return;

    next.revealed = true;

    // Afficher son vrai score
    const playerDiv = [...document.querySelectorAll(".player")]
      .find(d => d.dataset.name === next.name);
    playerDiv.querySelector(".score").textContent = next.score;
    playerDiv.classList.add("revealed");

    // RÃ©insÃ©rer correctement triÃ©
    reorderPlayers();
  }

  function reorderPlayers() {
    const revealedPlayers = shuffled.filter(p => p.revealed);

    // Trier seulement les rÃ©vÃ©lÃ©s
    revealedPlayers.sort((a, b) => b.score - a.score);

    revealedPlayers.forEach((p, index) => {
      const playerDiv = [...document.querySelectorAll(".player")]
        .find(d => d.dataset.name === p.name);

      resultsContainer.appendChild(playerDiv);

      // Couronne uniquement au premier
      if (index === 0) {
        playerDiv.classList.add("leader");
      } else {
        playerDiv.classList.remove("leader");
      }
    });
  }

  document.getElementById("revealBtn").addEventListener("click", revealNext);

  renderInitial();
</script>
</body>
</html>
